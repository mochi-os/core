{{define "title"}}{{if .Feed}}{{.Feed.Name}}{{else}}Feeds{{end}}{{end}}
{{template "head" .}}
<p class="header"><a href="/">Comms</a> | <a href="/feeds">Feeds</a>{{if .Feed}} | {{.Feed.Name}}{{end}}</p>

<style>.off { filter: grayscale(100%); }</style>

<!--TODO Check if logged in-->
<p><a href="/feeds/find">Subscribe to a feed</a>{{if .Feed}}{{if not .Feed.Owner}} | <a href="/feeds/{{.Feed.ID}}/unsubscribe">Unsubscribe from {{.Feed.Name}}</a>{{end}}{{end}} | <a href="/feeds/new">Create new feed</a>{{if .Owner}} | <a href="/feeds/post/new{{if .Feed}}?current={{.Feed.ID}}{{end}}">New post</a>{{end}}<br/>
<a href="/feeds">All feeds</a>{{range .Feeds}} | <a href="/feeds/{{.ID}}">{{.Name}}</a>{{end}}</p>

<div style="background: #dddddd; padding: 5px;">

{{range .Posts}}
<div style="background: white; margin: 10px; padding: 4px; border-radius: 6px;">
<pre>{{.Body}}</pre>

{{if len .Attachments}}<div style="overflow-x: auto; white-space: nowrap;">{{range .Attachments}}<a href="/files/{{.Feed}}/{{.File}}/{{.Name}}"><img src="/files/thumbnail/{{.Feed}}/{{.File}}/{{.Name}}" title="{{.Name}}"/></a>&nbsp;{{end}}</div>{{end}}

<p style="font-variant: small-caps;">{{if not $.Feed}}{{.FeedName}}, {{end}}{{.CreatedString}} | <a href="/feeds/{{.Feed}}/{{.ID}}/comment">New comment</a>&nbsp;
{{if ne .MyReaction ""}}<a href="/feeds/{{.Feed}}/{{.ID}}/react/none" title="None" class="off">&#128528;</a> {{end}}<a href="/feeds/{{.ID}}/{{.ID}}/react/like" title="Like" {{if ne .MyReaction "like"}}class="off"{{end}}>&#128515;</a> <a href="/feeds/{{.Feed}}/{{.ID}}/react/dislike" title="Dislike" {{if ne .MyReaction "dislike"}}class="off"{{end}}>&#128543;</a> <a href="/feeds/{{.Feed}}/{{.ID}}/react/laugh" title="Laugh" {{if ne .MyReaction "laugh"}}class="off"{{end}}>&#128541;</a> <a href="/feeds/{{.Feed}}/{{.ID}}/react/amazed" title="Amazed" {{if ne .MyReaction "amazed"}}class="off"{{end}}>&#128562;</a> <a href="/feeds/{{.Feed}}/{{.ID}}/react/love" title="Love" {{if ne .MyReaction "love"}}class="off"{{end}}>&#128536;</a> <a href="/feeds/{{.Feed}}/{{.ID}}/react/sad" title="Sad" {{if ne .MyReaction "sad"}}class="off"{{end}}>&#128542;</a> <a href="/feeds/{{.Feed}}/{{.ID}}/react/angry" title="Angry" {{if ne .MyReaction "angry"}}class="off"{{end}}>&#128544;</a><a href="/feeds/{{.Feed}}/{{.ID}}/react/agree" title="Agree" {{if ne .MyReaction "agree"}}class="off"{{end}}>&#128077;</a> <a href="/feeds/{{.Feed}}/{{.ID}}/react/disagree" title="Disagree" {{if ne .MyReaction "disagree"}}class="off"{{end}}>&#128078;</a>&nbsp;
{{range .Reactions}} | {{.Name}} {{if eq .Reaction "like"}}&#128515;{{end}}{{if eq .Reaction "dislike"}}&#128543;{{end}}{{if eq .Reaction "laugh"}}&#128541;{{end}}{{if eq .Reaction "amazed"}}&#128562;{{end}}{{if eq .Reaction "love"}}&#128536;{{end}}{{if eq .Reaction "sad"}}&#128542;{{end}}{{if eq .Reaction "angry"}}&#128544;{{end}}{{if eq .Reaction "agree"}}&#128077;{{end}}{{if eq .Reaction "disagree"}}&#128078;{{end}}{{end}}<br/>

<p>{{range .Comments}}{{template "feed_comment" .}}{{end}}</p>

</div>
{{end}}

</div>
{{template "foot" .}}

{{define "feed_comment"}}
	<div style="border-left: 2px solid blue; padding-left: 10px;">
    <pre>{{.Body}}</pre><p style="font-variant: small-caps;">{{.Name}} {{.CreatedString}} <a href="/feeds/{{.Feed}}/{{.Post}}/comment?parent={{.ID}}">Reply</a>&nbsp;
    {{if ne .MyReaction ""}}<a href="/feeds/{{.Feed}}/{{.Post}}/{{.ID}}/react/none" title="None" class="off">&#128528;</a> {{end}}<a href="/feeds/{{.Feed}}/{{.Post}}/{{.ID}}/react/like" title="Like" {{if ne .MyReaction "like"}}class="off"{{end}}>&#128515;</a> <a href="/feeds/{{.Feed}}/{{.Post}}/{{.ID}}/react/dislike" title="Dislike" {{if ne .MyReaction "dislike"}}class="off"{{end}}>&#128543;</a> <a href="/feeds/{{.Feed}}/{{.Post}}/{{.ID}}/react/laugh" title="Laugh" {{if ne .MyReaction "laugh"}}class="off"{{end}}>&#128541;</a> <a href="/feeds/{{.Feed}}/{{.Post}}/{{.ID}}/react/amazed" title="Amazed" {{if ne .MyReaction "amazed"}}class="off"{{end}}>&#128562;</a> <a href="/feeds/{{.Feed}}/{{.Post}}/{{.ID}}/react/love" title="Love" {{if ne .MyReaction "love"}}class="off"{{end}}>&#128536;</a> <a href="/feeds/{{.Feed}}/{{.Post}}/{{.ID}}/react/sad" title="Sad" {{if ne .MyReaction "sad"}}class="off"{{end}}>&#128542;</a> <a href="/feeds/{{.Feed}}/{{.Post}}/{{.ID}}/react/angry" title="Angry" {{if ne .MyReaction "angry"}}class="off"{{end}}>&#128544;</a> <a href="/feeds/{{.Feed}}/{{.Post}}/{{.ID}}/react/agree" title="Agree" {{if ne .MyReaction "agree"}}class="off"{{end}}>&#128077;</a> <a href="/feeds/{{.Feed}}/{{.Post}}/{{.ID}}/react/disagree" title="Disagree" {{if ne .MyReaction "disagree"}}class="off"{{end}}>&#128078;</a>&nbsp;
    {{range .Reactions}} | {{.Name}} {{if eq .Reaction "like"}}&#128515;{{end}}{{if eq .Reaction "dislike"}}&#128543;{{end}}{{if eq .Reaction "laugh"}}&#128541;{{end}}{{if eq .Reaction "amazed"}}&#128562;{{end}}{{if eq .Reaction "love"}}&#128536;{{end}}{{if eq .Reaction "sad"}}&#128542;{{end}}{{if eq .Reaction "angry"}}&#128544;{{end}}{{if eq .Reaction "agree"}}&#128077;{{end}}{{if eq .Reaction "disagree"}}&#128078;{{end}}{{end}}
    </p>
    {{range .Children}}{{template "feed_comment" .}}{{end}}
	</div>
{{end}}
